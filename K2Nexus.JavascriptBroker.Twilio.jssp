!function(){let e,t;metadata={systemName:"twilio.javascriptbroker.k2nexus",displayName:"Twilio Javascript Broker",description:"A JSSP based Twilio connector for K2 Nexus.",configuration:{"Account ID":{displayName:"Account Id",type:"string",required:!0},"Default From":{displayName:"Default 'From' Phone Number",type:"string"}}},ondescribe=async function({configuration:e}){postSchema({objects:{SMS:{displayName:"SMS",description:"Interact with Twilio's Programmable SMS API.",properties:{to:{displayName:"To",type:"string"},from:{displayName:"From",type:"string"},body:{displayName:"Body",type:"string"},mediaUrl:{displayName:"Media URL",type:"string"},status:{displayName:"Status",type:"string"}},methods:{sendSMS:{displayName:"Send SMS",type:"execute",inputs:["to","from","body","mediaUrl"],requiredInputs:["to","body"],outputs:["status"]}}}}})},onexecute=async function({objectName:a,methodName:s,parameters:o,properties:r,configuration:n,schema:i}){switch(e=n["Account ID"],t=n["Default From"],a){case"SMS":await async function(a,s){switch(a){case"sendSMS":await async function(a){return new Promise((s,o)=>{var r=function(e){if(!e.from&&!t)throw new Error("Missing 'From' contact number. Specify as a SmartObject property or Service Intance key.");return e.from?e.from:t}(a),n=new FormData;n.append("To",a.to),n.append("From",r),n.append("Body",a.body),function(e,t,a,s){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState)if(201==o.status||200==o.status)s(o.responseText);else{if(400!=o.status&&404!=o.status)throw postResult({}),new Error("Data: "+o.responseText);s(o.responseText)}},o.open(a.toUpperCase(),e),o.withCredentials=!0,o.setRequestHeader("Content-Type","multipart/form-data"),o.setRequestHeader("cache-control","no-cache"),o.send(t)}("https://api.twilio.com/2010-04-01/Accounts/"+e+"/Messages.json",n,"POST",(function(e){postResult({status:e.status}),s()}))})}(s)}}(s,r);break;default:throw new Error("The object "+a+" is not supported.")}}}();
//# sourceMappingURL=index.js.map
