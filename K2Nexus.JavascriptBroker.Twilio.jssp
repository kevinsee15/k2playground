!function(){let e,t;metadata={systemName:"twilio.javascriptbroker.k2nexus",displayName:"Twilio Javascript Broker",description:"A JSSP based Twilio connector for K2 Nexus.",configuration:{accountId:{displayName:"Account Id",type:"string",required:!0},defaultFrom:{displayName:"Default 'From' Phone Number",type:"string"}}},ondescribe=async function({configuration:e}){postSchema({objects:{SMS:{displayName:"SMS",description:"Interact with Twilio's Programmable SMS API.",properties:{to:{displayName:"To",type:"string"},from:{displayName:"From",type:"string"},body:{displayName:"Body",type:"string"},mediaUrl:{displayName:"Media URL",type:"string"},status:{displayName:"Status",type:"string"}},methods:{sendSMS:{displayName:"Send SMS",type:"execute",inputs:["to","from","body","mediaUrl"],requiredInputs:["to","body"],outputs:["status"]}}}}})},onexecute=async function({objectName:o,methodName:r,parameters:s,properties:a,configuration:n,schema:i}){switch(e=n.accountId,t=n.defaultFrom,o){case"SMS":await async function(e,t){switch(e){case"sendSMS":await async function(e){return new Promise((t,o)=>{let r=function(e){if(!e.from&&!this._defaultFrom)throw new Error("Missing 'From' contact number. Specify as a SmartObject property or Service Intance key.");return e.from?this._defaultFrom:e.from}(e);var s=JSON.stringify({to:e.to,from:r,body:"Hello World from Node.js!"});!function(e,t,o,r){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState){if(201!=s.status&&200!=s.status){if(400==s.status||404==s.status){e=JSON.parse(s.responseText);throw new Error(e.error.code+": "+e.error.message)}postResult({});e=JSON.parse(s.responseText);throw new Error(e.error.code+": "+e.error.message)}var e=JSON.parse(s.responseText);"function"==typeof r&&r(e)}},s.open(o.toUpperCase(),e),s.withCredentials=!0,s.setRequestHeader("Accept","application/json"),("PUT"==o.toUpperCase()||"POST"==o.toUpperCase()||"PATCH"==o.toUpperCase())&&s.setRequestHeader("Content-Type","application/json");s.send(t)}("https://api.twilio.com/2010-04-01/Accounts/"+this._accountId+"/Message.json",s,"POST",(function(e){postResult({status:e.status}),t()}))})}(t)}}(r,a);break;default:throw new Error("The object "+o+" is not supported.")}}}();
//# sourceMappingURL=index.js.map
